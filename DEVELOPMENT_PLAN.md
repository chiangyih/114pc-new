# 開發計畫書 (Development Plan)

**專案名稱**: 114 工科賽 PC 監控系統  
**版本**: 2.2  
**最後更新**: 2025-11-21  
**開發單位**: 新化高工 / 台中高工  
**崗位編號**: 01

---

## 📋 目錄

- [1. 專案概述](#1-專案概述)
- [2. 開發目標](#2-開發目標)
- [3. 開發範圍](#3-開發範圍)
- [4. 技術架構](#4-技術架構)
- [5. 開發里程碑](#5-開發里程碑)
- [6. 人員配置](#6-人員配置)
- [7. 風險管理](#7-風險管理)
- [8. 質量保證](#8-質量保證)
- [9. 部署與維護](#9-部署與維護)
- [10. 附錄](#10-附錄)

---

## 1. 專案概述

### 1.1 專案背景

本專案為 113 學年度全國高級中等學校工業類科學生技藝競賽 - 電腦修護職種第二站的應用程式，競賽主題為「個人電腦 USB / 藍牙介面卡製作及控制」。

### 1.2 專案目的

開發一套完整的 PC 端監控系統，用於：
- 監控電腦系統資源 (CPU、RAM) 使用情況
- 透過藍芽串列通訊與 MCU/Arduino 進行實時數據交互
- 支援 EEPROM 資料寫入功能
- 提供直觀的使用者介面和完整的錯誤處理

### 1.3 專案特色

| 特性 | 說明 |
|------|------|
| **即時監控** | CPU 和 RAM 使用率實時更新（每秒 1 次） |
| **顏色指示** | 根據負載程度自動切換顏色（綠/黃/紅） |
| **藍芽通訊** | 支援標準 HC-05 藍芽模組（9600 baud） |
| **自動偵測** | COM Port 熱插拔自動識別 |
| **EEPROM 支援** | 支援二進位資料轉換與寫入 |
| **完整註解** | 程式碼含完整中英文註解 |

### 1.4 競賽資訊

- **學年度**: 113 學年度
- **競賽名稱**: 全國高級中等學校工業類科學生技藝競賽
- **職類**: 電腦修護職種
- **站別**: 第二站
- **學校**: 新化高工 / 台中高工
- **崗位**: 01

---

## 2. 開發目標

### 2.1 功能目標

#### 第一期目標 (v1.0)
- [x] 基本的 COM Port 連線管理
- [x] CPU 使用率監控與顯示
- [x] RAM 使用率監控與顯示
- [x] 二進位輸入與 EEPROM 寫入
- [x] 藍芽模組名稱自動生成

#### 第二期目標 (v2.0)
- [x] 改進資料格式為文字協議
- [x] 修正 RAM 監控無數據問題
- [x] 完整的中文註解
- [x] COM Port 熱插拔監控

#### 第三期目標 (v2.2)
- [x] EEPROM 新格式 (WRITE + 數值 + \n)
- [x] 文檔統一與規格更新
- [x] 完整的技術規格書
- [x] 開發計畫書

### 2.2 品質目標

| 目標 | 標準 |
|------|------|
| **代碼品質** | 遵循 Visual Basic .NET 編碼規範 |
| **功能完整性** | 100% 實現規格書功能 |
| **穩定性** | 無未捕捉異常，完整的錯誤處理 |
| **可維護性** | 所有函數均有詳細註解 |
| **可用性** | 直觀的使用者介面，明確的使用者提示 |
| **相容性** | 支援 Windows 10/11、.NET 6.0+ |

### 2.3 性能目標

| 指標 | 目標 |
|------|------|
| **更新頻率** | 每秒 1 次 |
| **串列埠延遲** | < 100ms |
| **內存佔用** | < 100MB |
| **啟動時間** | < 3 秒 |
| **數據準確度** | ±1% |

---

## 3. 開發範圍

### 3.1 功能模塊

#### 3.1.1 通訊模塊 (Communication Module)
- COM Port 自動偵測與掃描
- 序列埠開啟/關閉管理
- 連線狀態管理
- 藍芽模組名稱計算

**技術**: System.IO.Ports.SerialPort, System.Management.ManagementEventWatcher

#### 3.1.2 監控模塊 (Monitoring Module)
- CPU 使用率讀取
- RAM 使用率讀取
- 性能計數器初始化
- 計時器控制

**技術**: System.Diagnostics.PerformanceCounter, System.Timers

#### 3.1.3 數據處理模塊 (Data Processing Module)
- 二進位轉十進位轉換
- 顏色值計算
- 數據格式化
- 數據驗證

**技術**: System.Text.RegularExpressions

#### 3.1.4 UI 模塊 (User Interface Module)
- 控件狀態管理
- 數據展示與更新
- 用戶交互處理
- 錯誤提示

**技術**: Windows Forms, System.Windows.Forms

### 3.2 外部依賴

| 依賴 | 版本 | 用途 |
|------|------|------|
| **.NET Framework** | 4.8 或 .NET 6.0+ | 應用程式運行環境 |
| **System.IO.Ports** | - | 序列埠通訊 |
| **System.Management** | - | COM Port 熱插拔偵測 |
| **System.Diagnostics** | - | 性能計數器 |

### 3.3 外部集成

#### 3.3.1 Arduino/MCU 端
- 接收 `LOAD{值}\n` 數據進行色彩指示
- 接收 `WRITE{值}\n` 數據進行 EEPROM 寫入
- 回傳連線確認訊號

#### 3.3.2 藍芽模組
- HC-05 或相容藍芽模組
- 標準串列埠虛擬裝置
- 9600 baud 通訊速率

---

## 4. 技術架構

### 4.1 系統架構圖

```
┌─────────────────────────────────────────────────────────┐
│                  PC 監控系統 (Windows)                   │
├─────────────────────────────────────────────────────────┤
│                                                           │
│  ┌──────────────────┐      ┌──────────────────┐        │
│  │   UI 層 (WinForms)│      │ 應用邏輯層       │        │
│  │                  │      │                  │        │
│  │ • 控件管理       │─────▶│ • 業務邏輯       │        │
│  │ • 事件處理       │      │ • 數據轉換       │        │
│  │ • 狀態顯示       │      │ • 驗證檢查       │        │
│  └──────────────────┘      └──────────────────┘        │
│           ▲                          │                   │
│           │                          ▼                   │
│           └──────────────────────────────────┐          │
│                                               │          │
│            ┌──────────────────────────────────┘         │
│            │                                             │
│            ▼                                             │
│  ┌──────────────────────────────────────────┐          │
│  │     系統資源層 (System Resources)         │          │
│  ├──────────────────────────────────────────┤          │
│  │ • PerformanceCounter (CPU, RAM)         │          │
│  │ • ManagementEventWatcher (COM Port)     │          │
│  │ • SerialPort (通訊)                      │          │
│  └──────────────────────────────────────────┘          │
│             │              │              │             │
└─────────────┼──────────────┼──────────────┼─────────────┘
              │              │              │
              ▼              ▼              ▼
          Windows     藍芽模組COM     效能計數器
          管理      虛擬埠 (COMx)       Service

                    ┌──────────────────┐
                    │  藍芽模組        │
                    │  (HC-05)         │
                    └──────────────────┘
                            │
                            ▼
                    ┌──────────────────┐
                    │  Arduino/MCU     │
                    │                  │
                    │ • WS2812 LED     │
                    │ • EEPROM         │
                    │ • 其他控制器     │
                    └──────────────────┘
```

### 4.2 類別結構

#### Form1 (主要應用類)

```visualbasic
Public Class Form1
    Inherits Form
    
    ' 常數
    Private Const STATION_NUMBER = 1
    Private Const BAUD_RATE = 9600
    
    ' 變數
    Private cpuCounter As PerformanceCounter
    Private ramCounter As PerformanceCounter
    Private portWatcher As ManagementEventWatcher
    
    ' 主要方法
    ' - 初始化: Form1_Load, InitializeUI, InitializePerformanceCounters
    ' - 連線: ButtonOpen_Click, ButtonClose_Click, ConfigureSerialPort
    ' - 監控: TimerCPU_Tick, TimerRAM_Tick, GetRAMUsage
    ' - EEPROM: ButtonWrite_Click
    ' - 熱插拔: InitializePortWatcher, OnPortChanged
    ' - 清理: CleanupResources
End Class
```

### 4.3 通訊協議

#### 4.3.1 連線確認

```
發送: 'c' (0x63)
時機: COM Port 連線成功後
用途: 通知 MCU 連線已建立
```

#### 4.3.2 CPU/RAM 監控數據

```
格式: "LOAD" + 數值 + "\n"
範例: LOAD30\n, LOAD65\n, LOAD90\n
週期: 每秒 1 次
方向: PC → MCU (單向)
```

#### 4.3.3 EEPROM 寫入

```
格式: "WRITE" + 數值 + "\n"
範例: WRITE5\n, WRITE12\n, WRITE15\n
用途: 寫入 EEPROM 資料
方向: PC → MCU (單向)
範圍: 0-15 (4 位二進位)
```

---

## 5. 開發里程碑

### 5.1 開發時程表

| 階段 | 版本 | 起訖日期 | 主要任務 | 狀態 |
|------|------|----------|---------|------|
| **第一期** | 1.0 | 2024-12-01 ~ 2024-12-20 | 基本功能實現 | ✅ 完成 |
| **第二期** | 2.0 | 2024-12-21 ~ 2025-01-05 | 格式改進與修復 | ✅ 完成 |
| **第三期** | 2.2 | 2025-01-06 ~ 2025-01-11 | 規格完善與文檔 | ✅ 完成 |
| **測試期** | - | 2025-01-12 ~ 2025-01-20 | 完整測試與調整 | ⏳ 進行中 |
| **上線期** | - | 2025-01-21 ~ 2025-02-XX | 競賽提交與驗收 | ⏳ 待開始 |

### 5.2 階段成果

#### v1.0.0 (基礎版)
- 基本 COM Port 連線
- CPU/RAM 監控
- EEPROM 寫入（二進位封包格式）
- 藍芽模組名稱生成

#### v2.0.0 (改進版)
- 改進資料格式為文字協議
- 修復 RAM 監控無數據問題
- 完整的中文註解

#### v2.2.0 (完善版)
- EEPROM 新格式（文字協議）
- 完整的技術規格書
- 開發計畫書
- 詳細的 Arduino 接收範例

---

## 6. 人員配置

### 6.1 開發團隊

| 角色 | 人數 | 職責 | 備註 |
|------|------|------|------|
| **專案經理** | 1 | 進度控制、風險管理、與競賽方協調 | - |
| **PC 端開發** | 1-2 | 窗口應用程式開發、通訊協議實現 | 主要工作 |
| **MCU 端開發** | 1-2 | Arduino 韌體開發、EEPROM 控制 | 平行開發 |
| **QA 工程師** | 1 | 功能測試、相容性測試 | 第二期開始 |
| **技術文檔** | 1 | 規格書、使用手冊編寫 | 並行進行 |

### 6.2 外部資源

| 資源 | 供應者 | 用途 |
|------|--------|------|
| **競賽資源** | 台中高工 / 新化高工 | 試題、競賽環境 |
| **技術支援** | 指導老師 | 規範檢查、建議 |
| **硬體** | 校內資源 | Arduino、藍芽模組、測試 PC |

---

## 7. 風險管理

### 7.1 技術風險

| 風險 | 影響度 | 可能性 | 因應對策 |
|------|--------|--------|---------|
| **性能計數器權限不足** | 高 | 中 | 以管理員權限執行、完整錯誤處理 |
| **藍芽連線不穩定** | 高 | 中 | 自動重連機制、連線狀態監控 |
| **MCU 端協議不相容** | 高 | 低 | 詳細規格書、提供 Arduino 範例 |
| **COM Port 熱插拔延遲** | 中 | 中 | 使用 WMI 事件、完整測試 |
| **.NET 版本相容性** | 中 | 低 | 測試多個 .NET 版本 |

### 7.2 進度風險

| 風險 | 影響度 | 因應對策 |
|------|--------|---------|
| **功能新增超期** | 高 | 明確的需求凍結、衝刺計畫 |
| **測試時間不足** | 高 | 早期自動化測試、並行測試 |
| **人員調動** | 中 | 代碼註解完整、知識轉移記錄 |

### 7.3 風險監控

- 週會審查進度與風險
- 每日站會更新狀態
- 記錄所有變更與決策

---

## 8. 質量保證

### 8.1 代碼審查

**標準**:
- 所有程式碼通過同行審查
- 必須包含簽名的 XML 註解
- 遵循命名規範 (PascalCase, camelCase)
- 無警告編譯

**檢查清單**:
- [ ] 代碼風格一致
- [ ] 完整的錯誤處理
- [ ] 無硬編碼值
- [ ] 適當的日誌記錄

### 8.2 功能測試

**測試範圍**:

| 功能 | 測試項 | 驗收標準 |
|------|--------|---------|
| **COM Port 連線** | 連線/斷線 | 狀態正確顯示 |
| **CPU 監控** | 數值讀取、顏色切換 | 誤差 ±1% |
| **RAM 監控** | 數值讀取、顏色切換 | 誤差 ±1% |
| **EEPROM 寫入** | 驗證、轉換、發送 | 100% 成功率 |
| **熱插拔** | COM Port 插拔 | 自動更新清單 |
| **異常處理** | 各種異常情況 | 無崩潰、有提示 |

### 8.3 相容性測試

**測試環境**:
- Windows 10 (21H2)
- Windows 11 (22H2)
- .NET Framework 4.8
- .NET 6.0+

**硬體配置**:
- 最小: Intel Core i3, 4GB RAM
- 建議: Intel Core i5, 8GB RAM

---

## 9. 部署與維護

### 9.1 發佈流程

1. **版本標記** - Git tag (v2.2.0)
2. **文檔準備** - 使用手冊、快速開始
3. **構建打包** - Release 組態編譯
4. **簽名驗證** - 代碼簽名檢查
5. **發行標籤** - GitHub Release

### 9.2 安裝說明

**前置要求**:
- Windows 10/11 系統
- .NET Runtime 6.0 或以上
- 管理員權限
- 藍芽驅動程式

**安裝步驟**:
```powershell
1. 下載 Release 版本
2. 解壓縮至目標資料夾
3. 執行 114pc-new.exe
4. 配置藍芽裝置
```

### 9.3 維護計畫

**定期維護**:
- 月度日誌檢查
- 三個月效能審查
- 六個月安全性審查

**問題修復**:
- 嚴重 bug: 24 小時內修復
- 一般 bug: 一週內修復
- 功能請求: 下一版本計畫

---

## 10. 附錄

### 10.1 相關文件

| 文件 | 位置 | 說明 |
|------|------|------|
| **技術規格書** | `TECH_SPEC.md` | 詳細的技術規格 |
| **使用手冊** | `README.md` | 快速開始與操作 |
| **API 文檔** | `Form1.vb` | 代碼內 XML 註解 |
| **通訊協議** | `CPU_RAM_Loading_Data_Format.md` | 詳細的協議說明 |
| **更新日誌** | `CHANGELOG.md` | 版本歷史與改變 |

### 10.2 參考資源

**Microsoft 官方文檔**:
- [PerformanceCounter](https://learn.microsoft.com/zh-tw/dotnet/api/system.diagnostics.performancecounter)
- [SerialPort](https://learn.microsoft.com/zh-tw/dotnet/api/system.io.ports.serialport)
- [ManagementEventWatcher](https://learn.microsoft.com/zh-tw/dotnet/api/system.management.managementeventwatcher)

**Arduino 相關**:
- [Arduino Serial](https://www.arduino.cc/reference/en/language/functions/communication/serial/)
- [Arduino EEPROM](https://www.arduino.cc/en/Reference/EEPROM)

**工具**:
- Visual Studio 2022 Community (免費)
- Git 版本控制
- Arduino IDE

### 10.3 聯絡資訊

| 項目 | 聯絡方式 |
|------|---------|
| **專案倉庫** | https://github.com/chiangyih/114pc-new |
| **開發單位** | 新化高工 / 台中高工 |
| **技術支援** | 指導老師 |

### 10.4 許可證

MIT License - 適用於學育用途

---

**文件資訊**

| 項 | 值 |
|---|---|
| **版本** | 2.2 |
| **狀態** | 草案完成 |
| **最後更新** | 2025-11-21 |
| **下一版預定** | 2025-02-01 |
| **審查者** | 待審核 |

---

*此文件遵循 GitHub Spec Kit 規範，適用於 GitHub 專案管理。*
